<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 760 740" fill="none">
  <style>
    text { font-family: system-ui, -apple-system, sans-serif; }
    .box { rx: 8; ry: 8; }
    .label { font-size: 14px; fill: #1a1a2e; font-weight: 600; }
    .sublabel { font-size: 11px; fill: #6b7280; }
    .arrow { stroke: #9ca3af; stroke-width: 1.5; marker-end: url(#ah); }
    .heading { font-size: 20px; fill: #3b82f6; font-weight: 700; }
    .section { font-size: 11px; fill: #788591; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; }
  </style>
  <defs>
    <marker id="ah" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6" fill="#9ca3af"/>
    </marker>
  </defs>

  <!-- Title -->
  <text class="heading" x="400" y="30" text-anchor="middle">wasmCloud v2 Architecture</text>

  <!-- Row 1: Developer â†’ wash CLI, kubectl/GitOps -->
  <ellipse cx="120" cy="80" rx="60" ry="24" fill="#f3f4f6" stroke="#788591" stroke-width="1.5"/>
  <text class="label" x="120" y="84" text-anchor="middle">Developer</text>

  <text class="sublabel" x="210" y="66" text-anchor="middle">builds</text>
  <line class="arrow" x1="180" y1="74" x2="248" y2="74"/>

  <rect class="box" x="250" y="58" width="140" height="44" fill="#e6f0f7" stroke="#005799" stroke-width="1.5"/>
  <text class="label" x="320" y="84" text-anchor="middle">wash CLI</text>

  <!-- "deploys" arrow routes below Developer ellipse to kubectl box -->
  <text class="sublabel" x="210" y="124" text-anchor="middle">deploys</text>
  <polyline class="arrow" points="120,104 120,130 498,130 498,102" fill="none"/>

  <rect class="box" x="480" y="58" width="180" height="44" fill="#e6f0f7" stroke="#005799" stroke-width="1.5"/>
  <text class="label" x="570" y="84" text-anchor="middle">kubectl / GitOps</text>

  <!-- Arrow down from kubectl to K8s API (straight down) -->
  <text class="sublabel" x="585" y="125">CRDs</text>
  <line class="arrow" x1="570" y1="102" x2="570" y2="158"/>

  <!-- Row 2: Kubernetes API Server -->
  <text class="section" x="20" y="178">KUBERNETES</text>
  <rect class="box" x="270" y="160" width="360" height="48" fill="#e6f9f3" stroke="#00bc8e" stroke-width="1.5"/>
  <text class="label" x="450" y="180" text-anchor="middle">Kubernetes API Server</text>
  <text class="sublabel" x="450" y="196" text-anchor="middle">etcd state store</text>

  <!-- Arrows down to CRDs (straight down from each CRD position) -->
  <line class="arrow" x1="340" y1="208" x2="340" y2="268"/>
  <line class="arrow" x1="500" y1="208" x2="500" y2="268"/>
  <line class="arrow" x1="605" y1="208" x2="605" y2="268"/>

  <!-- Row 3: CRDs -->
  <text class="section" x="20" y="295">CUSTOM RESOURCES</text>
  <rect class="box" x="235" y="270" width="210" height="44" fill="#fff8e6" stroke="#d4a017" stroke-width="1.5"/>
  <text class="label" x="340" y="296" text-anchor="middle">WorkloadDeployment</text>

  <rect class="box" x="460" y="270" width="80" height="44" fill="#fff8e6" stroke="#d4a017" stroke-width="1.5"/>
  <text class="label" x="500" y="296" text-anchor="middle">Host</text>

  <rect class="box" x="555" y="270" width="100" height="44" fill="#fff8e6" stroke="#d4a017" stroke-width="1.5"/>
  <text class="label" x="605" y="296" text-anchor="middle">Artifact</text>

  <!-- Arrow down from WorkloadDeployment to operator (straight down) -->
  <text class="sublabel" x="355" y="344">watches</text>
  <line class="arrow" x1="340" y1="314" x2="340" y2="370"/>

  <!-- Row 4: Operator + NATS -->
  <text class="section" x="20" y="398">OPERATOR</text>
  <rect class="box" x="260" y="372" width="180" height="48" fill="#f0ecff" stroke="#6741d9" stroke-width="1.5"/>
  <text class="label" x="350" y="392" text-anchor="middle">runtime-operator</text>
  <text class="sublabel" x="350" y="408" text-anchor="middle">Reconciler</text>

  <text class="sublabel" x="480" y="388" text-anchor="middle">schedules via</text>
  <line class="arrow" x1="440" y1="396" x2="518" y2="396"/>

  <rect class="box" x="520" y="372" width="170" height="48" fill="#e6f0f7" stroke="#005799" stroke-width="1.5"/>
  <text class="label" x="605" y="392" text-anchor="middle">NATS</text>
  <text class="sublabel" x="605" y="408" text-anchor="middle">Control Plane</text>

  <!-- Arrows down from NATS to Hosts (vertical then horizontal, no crossing) -->
  <polyline class="arrow" points="550,420 550,446 195,446 195,478" fill="none"/>
  <polyline class="arrow" points="595,420 595,456 410,456 410,478" fill="none"/>
  <line class="arrow" x1="640" y1="420" x2="640" y2="478"/>

  <!-- Row 5: Hosts -->
  <text class="section" x="20" y="505">HOSTS</text>
  <rect class="box" x="100" y="480" width="190" height="48" fill="#e6ecf3" stroke="#002e5d" stroke-width="1.5"/>
  <text class="label" x="195" y="500" text-anchor="middle">wasmCloud Host</text>
  <text class="sublabel" x="195" y="516" text-anchor="middle">+ Plugins</text>

  <rect class="box" x="315" y="480" width="190" height="48" fill="#e6ecf3" stroke="#002e5d" stroke-width="1.5"/>
  <text class="label" x="410" y="500" text-anchor="middle">wasmCloud Host</text>
  <text class="sublabel" x="410" y="516" text-anchor="middle">+ Plugins</text>

  <rect class="box" x="530" y="480" width="190" height="48" fill="#e6ecf3" stroke="#002e5d" stroke-width="1.5"/>
  <text class="label" x="625" y="500" text-anchor="middle">wasmCloud Host</text>
  <text class="sublabel" x="625" y="516" text-anchor="middle">+ Plugins</text>

  <!-- Arrows down to workloads -->
  <line class="arrow" x1="195" y1="528" x2="195" y2="558"/>
  <line class="arrow" x1="410" y1="528" x2="410" y2="558"/>
  <line class="arrow" x1="625" y1="528" x2="625" y2="558"/>

  <!-- Row 6: Workload contents -->
  <text class="section" x="20" y="585">WORKLOADS</text>

  <!-- Host 1 workloads -->
  <rect class="box" x="120" y="560" width="150" height="36" fill="#e6f9f3" stroke="#00bc8e" stroke-width="1.5"/>
  <text class="label" x="195" y="582" text-anchor="middle">Component</text>
  <rect class="box" x="120" y="606" width="150" height="36" fill="#e0f5f0" stroke="#099268" stroke-width="1.5"/>
  <text class="label" x="195" y="628" text-anchor="middle">Service</text>

  <!-- Host 2 workloads -->
  <rect class="box" x="335" y="560" width="150" height="36" fill="#e6f9f3" stroke="#00bc8e" stroke-width="1.5"/>
  <text class="label" x="410" y="582" text-anchor="middle">Component</text>
  <rect class="box" x="335" y="606" width="150" height="36" fill="#e6f9f3" stroke="#00bc8e" stroke-width="1.5"/>
  <text class="label" x="410" y="628" text-anchor="middle">Component</text>

  <!-- Host 3 workloads -->
  <rect class="box" x="550" y="560" width="150" height="36" fill="#e6f9f3" stroke="#00bc8e" stroke-width="1.5"/>
  <text class="label" x="625" y="582" text-anchor="middle">Component</text>

  <!-- Legend -->
  <rect class="box" x="90" y="680" width="16" height="16" fill="#e6f9f3" stroke="#00bc8e" stroke-width="1.5"/>
  <text class="sublabel" x="112" y="693">Component</text>

  <rect class="box" x="200" y="680" width="16" height="16" fill="#e0f5f0" stroke="#099268" stroke-width="1.5"/>
  <text class="sublabel" x="222" y="693">Service</text>

  <rect class="box" x="290" y="680" width="16" height="16" fill="#e6f9f3" stroke="#00bc8e" stroke-width="1.5"/>
  <text class="sublabel" x="312" y="693">Kubernetes</text>

  <rect class="box" x="390" y="680" width="16" height="16" fill="#fff8e6" stroke="#d4a017" stroke-width="1.5"/>
  <text class="sublabel" x="412" y="693">CRD</text>

  <rect class="box" x="460" y="680" width="16" height="16" fill="#f0ecff" stroke="#6741d9" stroke-width="1.5"/>
  <text class="sublabel" x="482" y="693">Operator</text>

  <rect class="box" x="550" y="680" width="16" height="16" fill="#e6ecf3" stroke="#002e5d" stroke-width="1.5"/>
  <text class="sublabel" x="572" y="693">Host</text>
</svg>
