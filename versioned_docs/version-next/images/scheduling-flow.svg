<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 500 670" fill="none">
  <style>
    text { font-family: system-ui, -apple-system, sans-serif; }
    .box { rx: 8; ry: 8; }
    .label { font-size: 13px; fill: #1a1a2e; font-weight: 600; }
    .sublabel { font-size: 11px; fill: #6b7280; }
    .arrow { stroke: #9ca3af; stroke-width: 1.5; marker-end: url(#ah); }
    .heading { font-size: 20px; fill: #3b82f6; font-weight: 700; }
    .step { font-size: 12px; fill: #ffffff; font-weight: 700; }
  </style>
  <defs>
    <marker id="ah" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6" fill="#9ca3af"/>
    </marker>
  </defs>

  <!-- Title -->
  <text class="heading" x="250" y="28" text-anchor="middle">v2 Workload Scheduling Flow</text>

  <!-- Step 1 -->
  <circle cx="52" cy="68" r="12" fill="#788591"/>
  <text class="step" x="52" y="72" text-anchor="middle">1</text>
  <rect class="box" x="75" y="50" width="380" height="36" fill="#f3f4f6" stroke="#788591" stroke-width="1.5"/>
  <text class="label" x="265" y="72" text-anchor="middle">Developer compiles .wasm (wash build)</text>

  <line class="arrow" x1="265" y1="86" x2="265" y2="114"/>

  <!-- Step 2 -->
  <circle cx="52" cy="132" r="12" fill="#d4a017"/>
  <text class="step" x="52" y="136" text-anchor="middle">2</text>
  <rect class="box" x="75" y="114" width="380" height="36" fill="#fff8e6" stroke="#d4a017" stroke-width="1.5"/>
  <text class="label" x="265" y="136" text-anchor="middle">Push to OCI registry (wash oci push)</text>

  <line class="arrow" x1="265" y1="150" x2="265" y2="178"/>

  <!-- Step 3 -->
  <circle cx="52" cy="196" r="12" fill="#d4a017"/>
  <text class="step" x="52" y="200" text-anchor="middle">3</text>
  <rect class="box" x="75" y="178" width="380" height="36" fill="#fff8e6" stroke="#d4a017" stroke-width="1.5"/>
  <text class="label" x="265" y="200" text-anchor="middle">Apply CRDs via kubectl / Helm / GitOps</text>

  <line class="arrow" x1="265" y1="214" x2="265" y2="242"/>

  <!-- Step 4 -->
  <circle cx="52" cy="264" r="12" fill="#00bc8e"/>
  <text class="step" x="52" y="268" text-anchor="middle">4</text>
  <rect class="box" x="75" y="244" width="380" height="40" fill="#e6f9f3" stroke="#00bc8e" stroke-width="1.5"/>
  <text class="label" x="265" y="262" text-anchor="middle">K8s API Server stores desired state</text>
  <text class="sublabel" x="265" y="276" text-anchor="middle">in etcd</text>

  <line class="arrow" x1="265" y1="284" x2="265" y2="316"/>

  <!-- Step 5 -->
  <circle cx="52" cy="338" r="12" fill="#6741d9"/>
  <text class="step" x="52" y="342" text-anchor="middle">5</text>
  <rect class="box" x="75" y="318" width="380" height="40" fill="#f0ecff" stroke="#6741d9" stroke-width="1.5"/>
  <text class="label" x="265" y="336" text-anchor="middle">runtime-operator reconciles desired state</text>
  <text class="sublabel" x="265" y="350" text-anchor="middle">creates WorkloadReplicaSet + Workload CRs</text>

  <line class="arrow" x1="265" y1="358" x2="265" y2="390"/>

  <!-- Step 6 -->
  <circle cx="52" cy="412" r="12" fill="#6741d9"/>
  <text class="step" x="52" y="416" text-anchor="middle">6</text>
  <rect class="box" x="75" y="392" width="380" height="40" fill="#f0ecff" stroke="#6741d9" stroke-width="1.5"/>
  <text class="label" x="265" y="410" text-anchor="middle">Operator resolves config from</text>
  <text class="sublabel" x="265" y="424" text-anchor="middle">ConfigMaps/Secrets, selects target Host</text>

  <line class="arrow" x1="265" y1="432" x2="265" y2="464"/>

  <!-- Step 7 -->
  <circle cx="52" cy="486" r="12" fill="#005799"/>
  <text class="step" x="52" y="490" text-anchor="middle">7</text>
  <rect class="box" x="75" y="466" width="380" height="40" fill="#e6f0f7" stroke="#005799" stroke-width="1.5"/>
  <text class="label" x="265" y="484" text-anchor="middle">Sends WorkloadStartRequest</text>
  <text class="sublabel" x="265" y="498" text-anchor="middle">to Host via NATS</text>

  <line class="arrow" x1="265" y1="506" x2="265" y2="538"/>

  <!-- Step 8 -->
  <circle cx="52" cy="560" r="12" fill="#002e5d"/>
  <text class="step" x="52" y="564" text-anchor="middle">8</text>
  <rect class="box" x="75" y="540" width="380" height="40" fill="#e6ecf3" stroke="#002e5d" stroke-width="1.5"/>
  <text class="label" x="265" y="558" text-anchor="middle">Host downloads .wasm component</text>
  <text class="sublabel" x="265" y="572" text-anchor="middle">instantiates in Wasmtime</text>

  <line class="arrow" x1="265" y1="580" x2="265" y2="612"/>

  <!-- Step 9 -->
  <circle cx="52" cy="634" r="12" fill="#00bc8e"/>
  <text class="step" x="52" y="638" text-anchor="middle">9</text>
  <rect class="box" x="75" y="614" width="380" height="40" fill="#e6f9f3" stroke="#00bc8e" stroke-width="1.5"/>
  <text class="label" x="265" y="632" text-anchor="middle">Host reports status</text>
  <text class="sublabel" x="265" y="646" text-anchor="middle">operator updates Workload CR status conditions</text>
</svg>
